/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package proyectofrontend;

import javax.swing.*;

import DAO.ApiDAO;
import DAO.PersonaDAO;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import componentes.LoggedListener;
import entidades.Persona;
import es.lanyu.ui.swing.SimpleJTable;
import vistas.VistaLogin;
import vistas.VistaReservas;


import java.awt.*;
import java.awt.event.*;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;

public class App {
  private static String token;
  private static boolean logged;
  private static List<LoggedListener> loggedListeners = new ArrayList<>();
  public static void main(String[] args) {

    VistaLogin login = new VistaLogin();
    VistaReservas reservas = new VistaReservas();

    addLoggedListener(new LoggedListener() {
      @Override
      public void onLoggedChanged(boolean logged) {
        if (logged) {
          login.setVisible(false);
          reservas.iniciarVistasReservas(1);
        } else {
          reservas.setVisible(false);
          login.setVisible(true);
        }
      }
    });

  }
  public static void loggear(String token){
    App.token = token;
    logged = true;
    notifyLoggedListeners(logged);

  }

  public static void addLoggedListener(LoggedListener listener) {
    loggedListeners.add(listener);
  }

  private static void notifyLoggedListeners(boolean logged) {
    for (LoggedListener listener : loggedListeners) {
      listener.onLoggedChanged(logged);
    }
  }
}
